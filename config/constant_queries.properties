#####################  SQLS   ######################################

###SQL GENERAL ###
#SQL_QUERY_GENERAL=SELECT MPT.ID_EXT_EMP||'|'||MCT.NOM_CLIENTE||'|'||SUBSTR(MPT.NRO_CUENTA,5)||'|'||PI.ID_VALOR_PERSONA||'|'||PM.PRIMER_NOMBRE||'|'||PM.SEGUNDO_NOMBRE||'|'||PM.PRIMER_APELLIDO||'|'||PM.SEGUNDO_APELLIDO||'|'||TO_CHAR(PM.FECHA_NACIMIENTO,'DD/MM/YYYY')||'|'||DECODE(PM.SEXO,'M','Masculino','F','Femenino')||'|'||PE.CORREO_ELECTRONICO||'|'||PT.NRO_TELEFONO AS "TRAMA" FROM C_PERSONA_ONLINE.PERSONA_ID PI, C_PERSONA_ONLINE.PERSONA_MAESTRO PM, C_PERSONA_ONLINE.PERSONA_TLF PT, C_PERSONA_ONLINE.PERSONA_EMAIL PE, NOVO04005.MAESTRO_PLASTICO_TEBCA MPT, NOVO04005.MAESTRO_CLIENTES_TEBCA MCT WHERE PI.ID_PERSONA=PM.ID_PERSONA AND PM.ID_PERSONA=PT.ID_PERSONA AND PM.ID_PERSONA=PE.ID_PERSONA AND PI.ID_VALOR_PERSONA=MPT.ID_EXT_PER AND MPT.ID_EXT_EMP=MCT.CIRIF_CLIENTE AND PM.ID_NACIONALIDAD LIKE 'Mx-Bn' QUERY_EXTRA

#SQL_QUERY_GENERAL=SELECT MPT.ID_EXT_EMP||'|'||MCT.NOM_CLIENTE||'|'||NA.NOTARJETA||'|'||NA.IDPERSONA||'|'||NA.NOMBRE1||'|'||NA.NOMBRE2||'|'||NA.APELLIDO1||'|'||NA.APELLIDO2||'|'||SUBSTR(NA.IDPERSONA,9,2)||'-'||SUBSTR(NA.IDPERSONA,7,2)||'-'||SUBSTR(NA.IDPERSONA,5,2)||'|'||DECODE(SUBSTR(NA.IDPERSONA,11,1),'H','HOMBRE','M','MUJER')||'|'||UPPER(NA.CORREO)||'|'||NA.TELEFONO2 AS TRAMA FROM NOVO04005.NOVO_AFILIACION NA, NOVO04005.MAESTRO_CLIENTES_TEBCA MCT, NOVO04005.MAESTRO_PLASTICO_TEBCA MPT WHERE NA.NOTARJETA=SUBSTR(MPT.NRO_CUENTA,5) AND MPT.ID_EXT_EMP=MCT.CIRIF_CLIENTE AND MPT.CON_ESTATUS NOT IN ('0','4','9') QUERY_EXTRA

#NUEVA CONSULTA PARA EMISIONES Y AFILIACIONES
SQL_QUERY_GENERAL=SELECT MPT.ID_EXT_EMP||'|'||MCT.NOM_CLIENTE||'|'||NA.NOTARJETA||'|'||NA.IDPERSONA||'|'||NA.NOMBRE1||'|'||NA.NOMBRE2||'|'||NA.APELLIDO1||'|'||NA.APELLIDO2||'|'||SUBSTR(NA.IDPERSONA,9,2)||'-'||SUBSTR(NA.IDPERSONA,7,2)||'-'||SUBSTR(NA.IDPERSONA,5,2)||'|'||DECODE(SUBSTR(NA.IDPERSONA,11,1),'H','HOMBRE','M','MUJER')||'|'||UPPER(NA.CORREO)||'|'||NA.TELEFONO2 AS TRAMA FROM NOVO04005.NOVO_AFILIACION NA, NOVO04005.MAESTRO_CLIENTES_TEBCA MCT, NOVO04005.MAESTRO_PLASTICO_TEBCA MPT WHERE NA.NOTARJETA=SUBSTR(MPT.NRO_CUENTA,5) AND MPT.ID_EXT_EMP=MCT.CIRIF_CLIENTE AND MPT.CON_ESTATUS NOT IN ('0','4','9') AND TO_CHAR(NA.FECHA_REG,'MM/YYYY')=TO_CHAR(SYSDATE,'MM/YYYY') UNION ALL SELECT MPT.ID_EXT_EMP||'|'||MCT.NOM_CLIENTE||'|'||NLE.NRO_TARJETA||'|'||NLE.ID_EXT_PER||'|'||NLE.NOMBRES||'|'||NLE.NOMBRES2||'|'||NLE.APELLIDOS||'|'||NLE.APELLIDOS2||'|'||SUBSTR(NLE.ID_EXT_PER,9,2)||'-'||SUBSTR(NLE.ID_EXT_PER,7,2)||'-'||SUBSTR(NLE.ID_EXT_PER,5,2)||'|'||DECODE(SUBSTR(NLE.ID_EXT_PER,11,1),'H','HOMBRE','M','MUJER')||'|'||UPPER(NLE.EMAIL)||'|'||NLE.TELF_CELULAR FROM NOVO04005.NOVO_LOTE_EMI NLE, NOVO04005.MAESTRO_CLIENTES_TEBCA MCT, NOVO04005.MAESTRO_PLASTICO_TEBCA MPT WHERE NLE.NRO_TARJETA=SUBSTR(MPT.NRO_CUENTA,5) AND MPT.ID_EXT_EMP=MCT.CIRIF_CLIENTE AND MPT.CON_ESTATUS NOT IN ('0','4','9') AND TO_CHAR(NLE.DTFECHAPROCESO,'MM/YYYY')=TO_CHAR(SYSDATE,'MM/YYYY')

SQL_ADD_FECHA_PUNTUAL=AND TO_CHAR(NA.FECHA_REG,'DD/MM/YYYY') = 'DATE'

#SQL_ADD_FECHA_ACTUAL=AND TO_CHAR(NA.FECHA_REG,'DD/MM/YYYY')=TO_CHAR(SYSDATE,'DD/MM/YYYY')

SQL_ADD_FECHA_ACTUAL=
